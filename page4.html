<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JS高级编程 | JS原型与原型链</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/js/assets/css/12.styles.e33a4478.css" as="style"><link rel="preload" href="/js/assets/js/app.cfcd0482.js" as="script"><link rel="preload" href="/js/assets/js/6.a1393811.js" as="script"><link rel="prefetch" href="/js/assets/js/4.a36cd5d1.js"><link rel="prefetch" href="/js/assets/js/0.675c1eb8.js"><link rel="prefetch" href="/js/assets/js/1.82f3f08a.js"><link rel="prefetch" href="/js/assets/js/2.ad68dd99.js"><link rel="prefetch" href="/js/assets/js/3.46f19ff2.js"><link rel="prefetch" href="/js/assets/js/5.dcbe4673.js"><link rel="prefetch" href="/js/assets/js/7.948ac6a7.js"><link rel="prefetch" href="/js/assets/js/8.99f6d086.js"><link rel="prefetch" href="/js/assets/js/9.0c5d26db.js"><link rel="prefetch" href="/js/assets/js/10.6a62cb63.js"><link rel="prefetch" href="/js/assets/js/11.e517648c.js">
    <link rel="stylesheet" href="/js/assets/css/12.styles.e33a4478.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/js/" class="home-link router-link-active"><!----><span class="site-name">
      JS高级编程
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><!----></div></header><div class="sidebar-mask"></div><div class="sidebar"><!----><ul class="sidebar-links"><li><a href="/js/page1.html" class="sidebar-link">数组</a></li><li><a href="/js/page2.html" class="sidebar-link">对象</a></li><li><a href="/js/page3.html" class="sidebar-link">JSON数据</a></li><li><a href="/js/page4.html" class="active sidebar-link">JS原型与原型链</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/js/page4.html#普通对象与函数对象" class="sidebar-link">普通对象与函数对象</a></li><li class="sidebar-sub-header"><a href="/js/page4.html#构造函数" class="sidebar-link">构造函数</a></li><li class="sidebar-sub-header"><a href="/js/page4.html#原型对象" class="sidebar-link">原型对象</a></li><li class="sidebar-sub-header"><a href="/js/page4.html#proto" class="sidebar-link">__proto__</a></li><li class="sidebar-sub-header"><a href="/js/page4.html#构造器" class="sidebar-link">构造器</a></li><li class="sidebar-sub-header"><a href="/js/page4.html#原型链" class="sidebar-link">原型链</a></li><li class="sidebar-sub-header"><a href="/js/page4.html#函数对象" class="sidebar-link">函数对象</a></li></ul></li><li><a href="/js/page5.html" class="sidebar-link">this指针、call和apply的区别</a></li><li><a href="/js/page6.html" class="sidebar-link">AJAX、跨域、服务器交互</a></li><li><a href="/js/page7.html" class="sidebar-link">JS面向对象</a></li><li><a href="/js/page8.html" class="sidebar-link">闭包</a></li><li><a href="/js/page9.html" class="sidebar-link">WebSocket教程</a></li><li><a href="/js/page10.html" class="sidebar-link">ES6常用特性</a></li><li><a href="/js/page11.html" class="sidebar-link">桌面通知 Notification</a></li></ul></div><div class="page"><div class="content"><h1 id="js原型与原型链"><a href="#js原型与原型链" aria-hidden="true" class="header-anchor">#</a> JS原型与原型链</h1><h2 id="普通对象与函数对象"><a href="#普通对象与函数对象" aria-hidden="true" class="header-anchor">#</a> 普通对象与函数对象</h2><p>JavaScript 中，万物皆对象！但对象也是有区别的。分为普通对象和函数对象，<code>Object</code> 、<code>Function</code> 是 JS 自带的<strong>函数对象</strong>。下面举例说明</p><pre class="language-js"><code>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Object<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//function  普通对象</span>

<span class="token keyword">var</span> o1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token keyword">var</span> o2 <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> o3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> o1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//object </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> o2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//object </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> o3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//object</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Function<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//function 函数对象</span>

<span class="token keyword">function</span> <span class="token function">f1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span> 
<span class="token keyword">var</span> <span class="token function-variable function">f2</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> f3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token string">'str'</span><span class="token punctuation">,</span><span class="token string">'console.log(str)'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> f1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//function </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> f2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//function </span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> f3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//function </span>

</code></pre><p>在上面的例子中 o1 o2 o3 为普通对象，f1 f2 f3 为函数对象。怎么区分，其实很简单，<strong>凡是通过 new Function() 创建的对象都是函数对象，其他的都是普通对象。f1,f2,归根结底都是通过 new Function()的方式进行创建的。Function Object 也都是通过 New Function()创建的</strong>。</p><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>一定要分清楚普通对象和函数对象，下面我们会常常用到它。</p></div><h2 id="构造函数"><a href="#构造函数" aria-hidden="true" class="header-anchor">#</a> 构造函数</h2><p>我们先复习一下构造函数的知识：</p><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> job<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>job <span class="token operator">=</span> job<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token punctuation">}</span> 
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Zaxlct'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token string">'Software Engineer'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">'Mick'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'Doctor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><p>上面的例子中 <code>person1</code> 和 <code>person2</code> 都是 <code>Person</code> 的实例。这两个实例都有一个 <code>constructor</code> （构造函数）属性，该属性（是一个<strong>指针</strong>）指向 <code>Person</code>。 即：</p><pre class="language-js"><code>  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person2<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre><p>我们要记住两个概念（构造函数，实例）：</p><p><code>person1</code> 和 <code>person2</code> 都是 构造函数 <code>Person</code> 的实例</p><div class="danger custom-block"><p class="custom-block-title">一个公式</p><p>实例的构造函数属性（constructor）指向构造函数。</p></div><h2 id="原型对象"><a href="#原型对象" aria-hidden="true" class="header-anchor">#</a> 原型对象</h2><p>在 <code>JavaScript</code> 中，每当定义一个对象（函数也是对象）时候，对象中都会包含一些<strong>预定义的属性</strong>。其中每个<strong>函数对象</strong>都有一个<code>prototype</code>属性，这个属性指向函数的原型对象。（先用不管什么是 <strong>proto</strong> 下面的课程会详细的剖析）</p><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Zaxlct'</span><span class="token punctuation">;</span>
Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>age  <span class="token operator">=</span> <span class="token number">28</span><span class="token punctuation">;</span>
Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>job  <span class="token operator">=</span> <span class="token string">'Software Engineer'</span><span class="token punctuation">;</span>
Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">sayName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
  
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
person1<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'Zaxlct'</span>

<span class="token keyword">var</span> person2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
person2<span class="token punctuation">.</span><span class="token function">sayName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'Zaxlct'</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person1<span class="token punctuation">.</span>sayName <span class="token operator">==</span> person2<span class="token punctuation">.</span>sayName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>

</code></pre><p>我们得到了本文第一个「定律」：</p><div class="danger custom-block"><p class="custom-block-title">定律</p><p>每个对象（包含普通和函数对象）都有 <strong>proto</strong> 属性，但只有函数对象才有 prototype 属性</p></div><p>那什么是原型对象呢？</p><p>我们把上面的例子改一改你就会明白了：</p><pre class="language-js"><code>Person<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token punctuation">{</span>
   name<span class="token punctuation">:</span>  <span class="token string">'Zaxlct'</span><span class="token punctuation">,</span>
   age<span class="token punctuation">:</span> <span class="token number">28</span><span class="token punctuation">,</span>
   job<span class="token punctuation">:</span> <span class="token string">'Software Engineer'</span><span class="token punctuation">,</span>
   sayName<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token function">alert</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><p>从上面的示例来看，原型对象，<strong>它就是一个普通对象</strong>。从现在开始你要牢牢记住原型对象就是 <code>Person.prototype</code> ，如果你还是害怕它，那就把它想想成一个字母 A： var A = Person.prototype。</p><p>在上面我们给 A 添加了 四个属性：<code>name</code>、<code>age</code>、<code>job</code>、<code>sayName</code>。其实它还有一个默认的属性：<code>constructor</code>。</p><div class="tip custom-block"><p class="custom-block-title">提示</p><p>在默认情况下，所有的<strong>原型对象</strong>都会自动获得一个 <code>constructor</code>（构造函数）属性，这个属性（是一个指针）指向 <code>prototype</code> 属性所在的函数（<code>Person</code>）</p></div><p>上面这句话有点拗口，我们「翻译」一下：A 有一个默认的 <code>constructor</code> 属性，这个属性是一个指针，指向 <code>Person</code>。即：</p><pre class="language-js"><code>Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person <span class="token comment">//true</span>
</code></pre><p>在上面的小节《构造函数》里，我们知道实例的构造函数属性（<code>constructor</code>）指向构造函数</p><pre class="language-js"><code>person1<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person
</code></pre><p>这两个「公式」好像有点联系：</p><pre class="language-js"><code>person1<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person
Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person
</code></pre><p><code>person1</code> 为什么有 <code>constructor</code> 属性？</p><blockquote><p>那是因为 person1 是 Person 的实例。</p></blockquote><p>那 <code>Person.prototype</code> 为什么有 <code>constructor</code> 属性？</p><blockquote><p>同理，<code>Person.prototype</code> （你把它想象成 A） 也是<code>Person</code>的实例。
也就是在 <code>Person</code> 创建的时候，创建了一个它的实例对象并赋值给它的 <code>prototype</code>，基本过程如下：</p></blockquote><pre class="language-js"><code><span class="token keyword">var</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Person<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token constant">A</span><span class="token punctuation">;</span>
</code></pre><div class="danger custom-block"><p class="custom-block-title">结论</p><p>原型对象（<code>Person.prototype</code>）是构造函数（<code>Person</code>）的一个实例。</p></div><p>原型对象其实就是<strong>普通对象</strong>（但 <code>Function.prototype</code> 除外，它是<strong>函数对象</strong>，但它很特殊，他没有<code>prototype</code>属性（前面说的函数对象都有<code>prototype</code>属性）。看下面的例子：</p><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">//Person{}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Person<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">//Object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Function<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// Function 这个特殊</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// Object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Function<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">//undefined</span>
</code></pre><p>Function.prototype 为什么是函数对象呢？</p><p>因为</p><pre class="language-js"><code><span class="token keyword">var</span> <span class="token constant">A</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Function<span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token constant">A</span><span class="token punctuation">;</span>
</code></pre><div class="warning custom-block"><p class="custom-block-title">原因</p><p>上文提到凡是通过 <code>new Function()</code> 产生的对象都是函数对象。因为 A 是函数对象，所以<code>Function.prototype</code>是函数对象。</p></div><p>那原型对象是用来做什么的呢？主要作用是用于继承。举个例子：</p><pre class="language-js"><code><span class="token keyword">var</span> <span class="token function-variable function">Person</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span> <span class="token comment">// tip: 当函数执行时这个 this 指的是谁？</span>
<span class="token punctuation">}</span>
Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>  <span class="token comment">// tip: 当函数执行时这个 this 指的是谁？</span>
<span class="token punctuation">}</span>
<span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">person</span><span class="token punctuation">(</span><span class="token string">'Mick'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
person1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Mick</span>
</code></pre><p>从这个例子可以看出，通过给 Person.prototype 设置了一个函数对象的属性，那有 Person 的实例（person1）出来的普通对象就继承了这个属性。具体是怎么实现的继承，就要讲到下面的原型链了。</p><p>小问题，上面两个 this 都指向谁？</p><pre class="language-js"><code><span class="token keyword">var</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">person</span><span class="token punctuation">(</span><span class="token string">'Mick'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
person1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Mick'</span><span class="token punctuation">;</span> <span class="token comment">// 此时 person1 已经有 name 这个属性了</span>
person1<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Mick  </span>
</code></pre><p><strong>故两次 <code>this</code> 在函数执行时都指向 <code>person1</code>。</strong></p><h2 id="proto"><a href="#proto" aria-hidden="true" class="header-anchor">#</a><strong>proto</strong></h2><p>JS 在创建对象（不论是普通对象还是函数对象）的时候，都有一个叫做__proto__ 的内置属性，用于指向创建它的构造函数的原型对象。</p><p>对象 <code>person1</code> 有一个 <code>__proto__</code>属性，创建它的构造函数是 <code>Person</code>，构造函数的原型对象是 <code>Person.prototype</code> ，所以：</p><pre class="language-js"><code>person1<span class="token punctuation">.</span>__proto__ <span class="token operator">==</span> Person<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
</code></pre><p>请看下图：</p><p><img src="/js/assets/img/prototype1.89462453.jpg" alt></p><p>《JavaScript 高级程序设计》的图 6-1</p><p>根据上面这个连接图，我们能得到：</p><pre class="language-js"><code>Person<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person<span class="token punctuation">;</span>
person1<span class="token punctuation">.</span>__proto__ <span class="token operator">==</span> Person<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
person1<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Person<span class="token punctuation">;</span>
</code></pre><p><strong>不过，要明确的真正重要的一点就是，这个连接存在于实例（person1）与构造函数（Person）的原型对象（Person.prototype）之间，而不是存在于实例（person1）与构造函数（Person）之间。</strong></p><div class="tip custom-block"><p class="custom-block-title">注意</p><p>因为绝大部分浏览器都支持<code>__proto__</code>属性，所以它才被加入了 ES6 里（ES5 部分浏览器也支持，但还不是标准）。</p></div><h2 id="构造器"><a href="#构造器" aria-hidden="true" class="header-anchor">#</a> 构造器</h2><p>熟悉 Javascript 的童鞋都知道，我们可以这样创建一个对象：</p><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">//它等同于下面这样：</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><p><code>obj</code> 是构造函数（<code>Object</code>）的一个实例。所以：</p><pre class="language-js"><code>obj<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Object
obj<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Object<span class="token punctuation">.</span>prototype
</code></pre><p>新对象 <code>obj</code> 是使用 <code>new</code> 操作符后跟一个<strong>构造函数</strong>来创建的。<strong>构造函数</strong>（<code>Object</code>）本身就是一个函数（就是上面说的函数对象），它和上面的构造函数 <code>Person</code> 差不多。只不过该函数是出于<strong>创建新对象的目的而定义的</strong>。所以不要被 <code>Object</code> 吓倒。</p><p>同理，可以创建对象的构造器不仅仅有 <code>Object</code>，也可以是 <code>Array</code>，<code>Date</code>，<code>Function</code>等。所以我们也可以构造函数来创建 <code>Array</code>、 <code>Date</code>、<code>Function</code></p><pre class="language-js"><code><span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
b<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Array<span class="token punctuation">;</span>
b<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
c<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Date<span class="token punctuation">;</span>
c<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Date<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>

<span class="token keyword">var</span> d <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
d<span class="token punctuation">.</span>constructor <span class="token operator">===</span> Function<span class="token punctuation">;</span>
d<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
</code></pre><p>这些构造器都是函数对象：</p><p><img src="/js/assets/img/prototype2.6bd06902.jpg" alt></p><p>函数对象</p><h2 id="原型链"><a href="#原型链" aria-hidden="true" class="header-anchor">#</a> 原型链</h2><p>小测试来检验一下你理解的怎么样：</p><ol><li><code>person1.__proto__</code> 是什么？</li><li><code>Person.__proto__</code> 是什么？</li><li><code>Person.prototype.__proto__</code> 是什么？</li><li><code>Object.__proto__</code> 是什么？</li><li><code>Object.prototype__proto__</code> 是什么？</li></ol><p><strong>答案：</strong></p><p><strong>第一题：</strong></p><ul><li>因为 <code>person1.__proto__</code> === <code>person1的构造函数</code>.prototype</li><li>因为 <code>person1的构造函数</code> === <code>Person</code></li><li>所以 <code>person1.__proto__</code> === <code>Person.prototype</code></li></ul><p><strong>第二题：</strong></p><ul><li>因为 <code>Person.__proto__</code> === <code>Person的构造函数</code>.prototype</li><li>因为 <code>Person的构造函数</code> === <code>Function</code></li><li>所以 <code>Person.__proto__</code> === <code>Function.prototype</code></li></ul><p><strong>第三题：</strong></p><ul><li><code>Person.prototype</code> 是一个普通对象，我们无需关注它有哪些属性，只要记住它是一个普通对象。</li><li>因为 <code>一个普通对象的构造函数</code> === <code>Object</code></li><li>所以 <code>Person.prototype.__proto__</code> === <code>Object.prototype</code></li></ul><p><strong>第四题：</strong></p><ul><li>参照第二题，因为 <code>Person</code> 和 <code>Object</code> 一样都是构造函数</li></ul><p><strong>第五题：</strong></p><ul><li><code>Object.prototype</code> 对象也有<code>proto</code>属性，但它比较特殊，为 <code>null</code> 。</li><li>因为 <code>null</code> 处于原型链的顶端，<strong>这个只能记住</strong>。</li><li>所以 <code>Object.prototype.__proto__</code> === null</li></ul><h2 id="函数对象"><a href="#函数对象" aria-hidden="true" class="header-anchor">#</a> 函数对象</h2><blockquote><p>所有函数对象的<code>proto</code>都指向<code>Function.prototype</code>，它是一个空函数（Empty function）</p></blockquote><pre class="language-js"><code>Number<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype  <span class="token comment">// true</span>
Number<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function <span class="token comment">//true</span>

Boolean<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
Boolean<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function <span class="token comment">//true</span>

String<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype  <span class="token comment">// true</span>
String<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function <span class="token comment">//true</span>

<span class="token comment">// 所有的构造器都来自于Function.prototype，甚至包括根构造器Object及Function自身</span>
Object<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype  <span class="token comment">// true</span>
Object<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function <span class="token comment">// true</span>

<span class="token comment">// 所有的构造器都来自于Function.prototype，甚至包括根构造器Object及Function自身</span>
Function<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
Function<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function <span class="token comment">//true</span>

Array<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype   <span class="token comment">// true</span>
Array<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function <span class="token comment">//true</span>

RegExp<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype  <span class="token comment">// true</span>
RegExp<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function <span class="token comment">//true</span>

Error<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype   <span class="token comment">// true</span>
Error<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function <span class="token comment">//true</span>

Date<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype    <span class="token comment">// true</span>
Date<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Function <span class="token comment">//true</span>
</code></pre><p>JavaScript中有内置(build-in)构造器/对象共计12个（ES5中新加了JSON），这里列举了可访问的8个构造器。</p><p>Math，JSON是以对象形式存在的，无需new。它们的proto是Object.prototype。如下</p><pre class="language-js"><code>Math<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Object<span class="token punctuation">.</span>prototype  <span class="token comment">// true</span>
Math<span class="token punctuation">.</span>construrctor <span class="token operator">==</span> Object <span class="token comment">// true</span>

<span class="token constant">JSON</span><span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Object<span class="token punctuation">.</span>prototype  <span class="token comment">// true</span>
<span class="token constant">JSON</span><span class="token punctuation">.</span>construrctor <span class="token operator">==</span> Object <span class="token comment">//true</span>
</code></pre><p>上面说的函数对象当然包括自定义的。如下</p><pre class="language-js"><code><span class="token comment">// 函数声明</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 函数表达式</span>
<span class="token keyword">var</span> <span class="token function-variable function">Perosn</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// true</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Man<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Function<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>    <span class="token comment">// true</span>
</code></pre><p>这说明什么呢？</p><p><strong>所有的构造器都来自于 <code>Function.prototype</code>，甚至包括根构造器<code>Object</code>及<code>Function</code>自身。<code>所有构造器都继承了·Function.prototype</code>的属性及方法。如<code>length</code>、<code>call</code>、<code>apply</code>、<code>bind</code></strong></p><p><code>Function.prototype</code>也是唯一一个typeof xxx.prototype为function的<code>prototype</code>。其它的构造器的<code>prototype</code>都是一个对象:</p><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Function<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// function</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>   <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Number<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>   <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Boolean<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>  <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> String<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>   <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Array<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>    <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> RegExp<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>   <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Error<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>    <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Date<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>     <span class="token comment">// object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span>   <span class="token comment">// object</span>
</code></pre><p>知道了所有构造器（含内置及自定义）的<code>__proto__</code>都是<code>Function.prototype</code>，那<code>Function.prototype</code>的<code>__proto__</code>是谁呢？</p><p>相信都听说过JavaScript中函数也是<strong>一等公民</strong>，那从哪能体现呢？如下</p><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Function<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">)</span> <span class="token comment">// true</span>
</code></pre><p>这说明所有的构造器也都是一个普通 JS 对象，可以给构造器添加/删除属性等。同时它也继承了<code>Object.prototype</code>上的所有方法：<code>toString</code>、<code>valueOf</code>、<code>hasOwnProperty</code>等。</p><p>最后<code>Object.prototype</code>的<code>proto</code>是谁？</p><pre class="language-js"><code>Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token comment">// true</span>
</code></pre><p>已经到顶了，为<code>null</code>。</p></div><!----><div class="content page-nav"><p class="inner"><span class="prev">
        ← <a href="/js/page3.html" class="prev">
          JSON数据
        </a></span><span class="next"><a href="/js/page5.html">
          this指针、call和apply的区别
        </a> →
      </span></p></div></div></div></div>
    <script src="/js/assets/js/6.a1393811.js" defer></script><script src="/js/assets/js/app.cfcd0482.js" defer></script>
  </body>
</html>
